<!DOCTYPE html>
<html>
<head>
	<title>game map</title>
</head>
<body onload="main()">

hello world
<pre>
{{map}}
</pre>


<style type="text/css">
pre {
	background: lightgray;
	padding: 0.5em;
}
</style>


<script type="text/javascript">
function main() {
	window.onkeydown = movekey;
	action();
}
function movekey(e) {
	switch (e.key) {
	case "ArrowUp":     action("walk=n");  break;
	case "ArrowDown":   action("walk=s");  break;
	case "ArrowLeft":   action("walk=w");  break;
	case "ArrowRight":  action("walk=e");  break;
	default:  console.log(e.key);
	}
}
function action(actionstr) {
	actionstr = ( actionstr || "" ) + "";
	fetch(`/action.json?${actionstr}`).then(d => d.json()).then(d => {
		console.log(d);
		let pre = document.querySelector("pre");
		pre.innerHTML = "";
		d.map.data.forEach(v => pre.innerHTML += v + "\n");
		// pre.innerHTML = JSON.stringify(d.map);
	});
}
</script>


</body>
</html>